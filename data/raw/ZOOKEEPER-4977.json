{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13628894", "self": "https://issues.apache.org/jira/rest/api/2/issue/13628894", "key": "ZOOKEEPER-4977", "fields": {"fixVersions": [], "resolution": {"self": "https://issues.apache.org/jira/rest/api/2/resolution/8", "id": "8", "description": "The described issue is not actually a problem - it is as designed.", "name": "Not A Problem"}, "customfield_12312322": null, "customfield_12312323": null, "customfield_12310420": "9223372036854775807", "customfield_12312320": null, "customfield_12312321": null, "customfield_12312328": null, "customfield_12312329": null, "customfield_12312326": null, "customfield_12310300": null, "customfield_12312327": null, "customfield_12312324": null, "customfield_12312720": null, "customfield_12312325": null, "lastViewed": null, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/2", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/critical.svg", "name": "Critical", "id": "2"}, "labels": ["security"], "customfield_12312333": null, "customfield_12312334": null, "customfield_12313422": "false", "customfield_12310310": "1.0", "customfield_12312331": null, "customfield_12312332": null, "aggregatetimeoriginalestimate": null, "timeestimate": null, "customfield_12312330": null, "versions": [{"self": "https://issues.apache.org/jira/rest/api/2/version/12354432", "id": "12354432", "description": "", "name": "3.9.3", "archived": false, "released": true, "releaseDate": "2024-10-24"}], "customfield_12311120": null, "customfield_12313826": null, "issuelinks": [], "customfield_12312339": null, "customfield_12313825": null, "assignee": null, "customfield_12312337": null, "customfield_12313823": null, "customfield_12312338": null, "customfield_12311920": null, "customfield_12313822": null, "customfield_12312335": null, "customfield_12313821": null, "customfield_12312336": null, "customfield_12313820": null, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}, "components": [{"self": "https://issues.apache.org/jira/rest/api/2/component/12329414", "id": "12329414", "name": "security"}], "archiveddate": null, "customfield_12312026": null, "customfield_12312023": null, "customfield_12312024": null, "aggregatetimeestimate": null, "customfield_12312022": null, "customfield_12310921": null, "customfield_12310920": "9223372036854775807", "customfield_12312823": null, "creator": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=aost", "name": "aost", "key": "JIRAUSER306938", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "zhangpeng", "active": true, "timeZone": "Asia/Shanghai"}, "subtasks": [], "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=aost", "name": "aost", "key": "JIRAUSER306938", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "zhangpeng", "active": true, "timeZone": "Asia/Shanghai"}, "aggregateprogress": {"progress": 0, "total": 0}, "customfield_12313520": null, "customfield_12310250": null, "progress": {"progress": 0, "total": 0}, "customfield_12313924": null, "votes": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4977/votes", "votes": 0, "hasVoted": false}, "worklog": {"startAt": 0, "maxResults": 20, "total": 0, "worklogs": []}, "archivedby": null, "customfield_12313920": null, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/1", "id": "1", "description": "A problem which impairs or prevents the functions of the product.", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype", "name": "Bug", "subtask": false, "avatarId": 21133}, "timespent": null, "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@62587d62[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@37cf4984[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47982317[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@ad6c109[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3bac4f96[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@a19f503[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@c1fefcc[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@30fda9cf[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@697490b9[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@2c00d179[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5f123aba[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@2fc5346[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}", "customfield_12314141": null, "customfield_12314140": null, "project": {"self": "https://issues.apache.org/jira/rest/api/2/project/12310801", "id": "12310801", "key": "ZOOKEEPER", "name": "ZooKeeper", "projectTypeKey": "software", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011", "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011", "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011", "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"}, "projectCategory": {"self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10484", "id": "10484", "description": "Apache ZooKeeper related", "name": "ZooKeeper"}}, "aggregatetimespent": null, "customfield_12312520": null, "customfield_12312521": "Mon Sep 15 16:02:09 UTC 2025", "customfield_12314422": null, "customfield_12314421": null, "customfield_12314146": null, "customfield_12314420": null, "customfield_12314145": null, "customfield_12314144": null, "customfield_12314143": null, "resolutiondate": "2025-09-15T16:02:09.000+0000", "workratio": -1, "customfield_12312923": null, "customfield_12312920": null, "customfield_12312921": null, "watches": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4977/watchers", "watchCount": 2, "isWatching": false}, "created": "2025-09-15T08:05:25.000+0000", "customfield_12310192": null, "customfield_12310191": null, "customfield_12310230": null, "updated": "2025-09-15T16:02:09.000+0000", "timeoriginalestimate": null, "description": "{{superDigest}} configuration found in embedded {{pom.xml}} within zookeeper-3.9.3.jar\r\n\r\n \r\n<zookeeper.DigestAuthenticationProvider.superDigest>super:D/InIHSb7yEEbrWz8b9l71RjZJU=</zookeeper.DigestAuthenticationProvider.superDigest>\r\n \r\n*Environment:*\r\n * ZooKeeper Version: 3.9.3 (the official binary distribution from Maven Central)\r\n\r\n * JDK Version: N/A (discovered during static analysis of the JAR file)\r\n\r\n * OS: N/A\r\n\r\n*Problem Description:*\r\nDuring a routine security audit of our application dependencies, we discovered that the {{zookeeper-3.9.3.jar}} file contains its own {{pom.xml}} file at the path {{{}META-INF/maven/org.apache.zookeeper/zookeeper/pom.xml{}}}. This embedded {{pom.xml}} file includes a property configuration for {{zookeeper.DigestAuthenticationProvider.superDigest}} with a pre-defined hash value.\r\n\r\n*Steps to Reproduce:*\r\n # Download the official {{org.apache.zookeeper:zookeeper:3.9.3}} JAR from Maven Central.\r\n\r\n # Extract the JAR file or use a tool ({{{}jar -tf{}}}, {{{}unzip -l{}}}, IDE) to list its contents.\r\n\r\n # Locate the file {{META-INF/maven/org.apache.zookeeper/zookeeper/pom.xml}} inside the JAR.\r\n\r\n # Inspect the content of this {{pom.xml}} file. On line 283 (or nearby), you will find:\r\n{{<zookeeper.DigestAuthenticationProvider.superDigest>super:D/InIHSb7yEEbrWz8b9l71RjZJU=</zookeeper.DigestAuthenticationProvider.superDigest>}}\r\n\r\n*Expected Behavior:*\r\nThe published binary JAR artifacts should not contain any residual or testing configuration files that include sensitive properties, especially those related to security authentication like the superuser digest. The build/packaging process should strip such elements from the final release artifact.\r\n\r\n*Actual Behavior:*\r\nThe released {{zookeeper-3.9.3.jar}} contains an embedded {{pom.xml}} which includes a configured {{superDigest}} property. While this is a hash and not a plaintext password, its presence in a widely distributed binary is a potential security risk.\r\n\r\n*Potential Risk:*\r\n # *Information Disclosure:* This exposes a known credential hash, which violates the principle of least surprise and could be used in conjunction with other vulnerabilities (e.g., CVE-2014-085 - information disclosure in logs).\r\n\r\n # *Increased Attack Surface:* If an attacker gains access to the JAR file (e.g., through a deployment leak), they extract this hash. Although SHA-1 hashing is used, it could potentially be targeted for brute-force attacks if the original password was weak, potentially granting superuser access to a ZooKeeper ensemble.\r\n\r\n # *Bad Practice:* The presence of this configuration, even if not activated by default, sets a poor security precedent for users who might find it and mistakenly use it without generating a new secure digest.\r\n \r\n!image-2025-09-15-16-00-33-152.png!", "customfield_10010": null, "timetracking": {}, "customfield_12314523": null, "customfield_12314127": null, "customfield_12314522": null, "customfield_12314126": null, "customfield_12314521": null, "customfield_12314125": null, "customfield_12314520": null, "customfield_12314124": null, "customfield_12312340": null, "attachment": [{"self": "https://issues.apache.org/jira/rest/api/2/attachment/13078385", "id": "13078385", "filename": "5F7DE753-B347-43A9-9B84-401BA743C4C1.png", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=aost", "name": "aost", "key": "JIRAUSER306938", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "zhangpeng", "active": true, "timeZone": "Asia/Shanghai"}, "created": "2025-09-15T08:11:03.188+0000", "size": 78491, "mimeType": "image/png", "content": "https://issues.apache.org/jira/secure/attachment/13078385/5F7DE753-B347-43A9-9B84-401BA743C4C1.png"}], "customfield_12314123": null, "customfield_12312341": null, "customfield_12312220": null, "customfield_12314122": null, "customfield_12314121": null, "customfield_12314120": null, "customfield_12314129": null, "customfield_12314524": null, "customfield_12314128": null, "summary": "superDigest configuration found in embedded pom.xml within zookeeper-3.9.3.jar", "customfield_12314130": null, "customfield_12310291": null, "customfield_12310290": null, "customfield_12311024": null, "customfield_12314138": null, "customfield_12314137": null, "environment": null, "customfield_12314136": null, "customfield_12314135": null, "customfield_12311020": null, "customfield_12314134": null, "duedate": null, "customfield_12314132": null, "customfield_12314131": null, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13628894/comment/18020397", "id": "18020397", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ctubbsii", "name": "ctubbsii", "key": "ctubbsii", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=ctubbsii&avatarId=15840", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ctubbsii&avatarId=15840", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ctubbsii&avatarId=15840", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ctubbsii&avatarId=15840"}, "displayName": "Christopher Tubbs", "active": true, "timeZone": "America/New_York"}, "body": "How exactly is this a problem? The embedded pom.xml file is just a copy of the pom.xml file that maven used to build the jar. It is for reference only. It's not a runtime configuration file in any way and does not represent any runtime security configuration. That value is a test value used only during the maven build for testing using ZooKeeper's unit and integration tests. It should have no impact on any user deployments.\r\n\r\n \r\n\r\nThis does not appear to be a problem to fix.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ctubbsii", "name": "ctubbsii", "key": "ctubbsii", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=ctubbsii&avatarId=15840", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ctubbsii&avatarId=15840", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ctubbsii&avatarId=15840", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ctubbsii&avatarId=15840"}, "displayName": "Christopher Tubbs", "active": true, "timeZone": "America/New_York"}, "created": "2025-09-15T15:57:08.812+0000", "updated": "2025-09-15T15:57:08.812+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13628894/comment/18020399", "id": "18020399", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ctubbsii", "name": "ctubbsii", "key": "ctubbsii", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=ctubbsii&avatarId=15840", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ctubbsii&avatarId=15840", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ctubbsii&avatarId=15840", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ctubbsii&avatarId=15840"}, "displayName": "Christopher Tubbs", "active": true, "timeZone": "America/New_York"}, "body": "This is not a problem. The configuration is a test value for unit testing with maven-surefire-plugin, and has no impact on user configuration or deployments. This does not represent bad practice, but is the normal, acceptable, best practice way of setting test values for testing.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ctubbsii", "name": "ctubbsii", "key": "ctubbsii", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=ctubbsii&avatarId=15840", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=ctubbsii&avatarId=15840", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=ctubbsii&avatarId=15840", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=ctubbsii&avatarId=15840"}, "displayName": "Christopher Tubbs", "active": true, "timeZone": "America/New_York"}, "created": "2025-09-15T16:02:09.699+0000", "updated": "2025-09-15T16:02:09.699+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "customfield_12311820": "0|z1xoug:", "customfield_12314139": null}}