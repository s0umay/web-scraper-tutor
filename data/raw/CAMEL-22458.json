{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13630049", "self": "https://issues.apache.org/jira/rest/api/2/issue/13630049", "key": "CAMEL-22458", "fields": {"fixVersions": [{"self": "https://issues.apache.org/jira/rest/api/2/version/12356302", "id": "12356302", "description": "Dec 2025", "name": "4.10.8", "archived": false, "released": false}, {"self": "https://issues.apache.org/jira/rest/api/2/version/12356301", "id": "12356301", "description": "Nov 2025", "name": "4.14.2", "archived": false, "released": true, "releaseDate": "2025-11-01"}, {"self": "https://issues.apache.org/jira/rest/api/2/version/12356295", "id": "12356295", "description": "Nov 2025", "name": "4.16.0", "archived": false, "released": false}], "resolution": {"self": "https://issues.apache.org/jira/rest/api/2/resolution/1", "id": "1", "description": "A fix for this issue is checked into the tree and tested.", "name": "Fixed"}, "customfield_12312322": null, "customfield_12312323": null, "customfield_12310420": "9223372036854775807", "customfield_12312320": null, "customfield_12312321": null, "customfield_12312328": null, "customfield_12312329": null, "customfield_12312326": null, "customfield_12310300": null, "customfield_12312327": null, "customfield_12312324": null, "customfield_12312720": null, "customfield_12312325": null, "lastViewed": null, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "labels": ["flatpack"], "customfield_12312333": null, "customfield_12312334": null, "customfield_12313422": "false", "customfield_12310310": "0.0", "customfield_12312331": null, "customfield_12312332": null, "aggregatetimeoriginalestimate": null, "timeestimate": null, "customfield_12312330": null, "versions": [{"self": "https://issues.apache.org/jira/rest/api/2/version/12356047", "id": "12356047", "description": "Aug 2025 (LTS)", "name": "4.14.0", "archived": false, "released": true, "releaseDate": "2025-08-19"}], "customfield_12311120": null, "customfield_12313826": null, "issuelinks": [], "customfield_12312339": null, "customfield_12313825": null, "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=davsclaus", "name": "davsclaus", "key": "davsclaus", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"}, "displayName": "Claus Ibsen", "active": true, "timeZone": "Europe/Berlin"}, "customfield_12312337": null, "customfield_12313823": null, "customfield_12312338": null, "customfield_12311920": null, "customfield_12313822": null, "customfield_12312335": null, "customfield_12313821": null, "customfield_12312336": null, "customfield_12313820": null, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}, "components": [], "customfield_12310080": null, "archiveddate": null, "customfield_12312026": null, "customfield_12312023": null, "customfield_12312024": null, "aggregatetimeestimate": null, "customfield_12312022": null, "customfield_12310921": null, "customfield_12310920": "9223372036854775807", "customfield_12312823": null, "creator": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=gandrinor", "name": "gandrinor", "key": "JIRAUSER311059", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34056", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34056", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34056", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34056"}, "displayName": "Gandrinor", "active": true, "timeZone": "Etc/UTC"}, "subtasks": [], "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=gandrinor", "name": "gandrinor", "key": "JIRAUSER311059", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=34056", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=34056", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=34056", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=34056"}, "displayName": "Gandrinor", "active": true, "timeZone": "Etc/UTC"}, "aggregateprogress": {"progress": 0, "total": 0}, "customfield_12313520": null, "customfield_12310250": null, "progress": {"progress": 0, "total": 0}, "customfield_12313924": null, "votes": {"self": "https://issues.apache.org/jira/rest/api/2/issue/CAMEL-22458/votes", "votes": 0, "hasVoted": false}, "worklog": {"startAt": 0, "maxResults": 20, "total": 0, "worklogs": []}, "archivedby": null, "customfield_12313920": null, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/1", "id": "1", "description": "A problem which impairs or prevents the functions of the product.", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype", "name": "Bug", "subtask": false, "avatarId": 21133}, "timespent": null, "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@7764170c[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@635f284[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@712e6573[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@58260800[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@21e54e19[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@299e8343[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@2b196efe[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@43170595[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@48091e68[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@15d018b1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@755efa6b[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@e9e62f8[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}", "customfield_12314141": null, "customfield_12314140": null, "project": {"self": "https://issues.apache.org/jira/rest/api/2/project/12311211", "id": "12311211", "key": "CAMEL", "name": "Camel", "projectTypeKey": "software", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12311211&avatarId=10011", "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12311211&avatarId=10011", "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12311211&avatarId=10011", "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12311211&avatarId=10011"}, "projectCategory": {"self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10482", "id": "10482", "description": "", "name": "Camel"}}, "customfield_12310060": {"self": "https://issues.apache.org/jira/rest/api/2/customFieldOption/10061", "value": "Novice", "id": "10061", "disabled": false}, "aggregatetimespent": null, "customfield_12312520": null, "customfield_12312521": "Tue Oct 07 12:06:54 UTC 2025", "customfield_12314422": null, "customfield_12314421": null, "customfield_12314146": null, "customfield_12314420": null, "customfield_12314145": null, "customfield_12314144": null, "customfield_12314143": null, "resolutiondate": "2025-10-07T12:06:54.000+0000", "workratio": -1, "customfield_12312923": null, "customfield_12312920": null, "customfield_12312921": null, "watches": {"self": "https://issues.apache.org/jira/rest/api/2/issue/CAMEL-22458/watchers", "watchCount": 2, "isWatching": false}, "created": "2025-09-26T09:15:45.000+0000", "updated": "2025-10-07T12:06:54.000+0000", "timeoriginalestimate": null, "description": "*Errror Szenario*\r\n\r\nWhen org.apache.camel.component.flatpack.FlatpackConverter toMap function is called, for example while using the org.apache.camel.component.flatpack.DataSetList iterator, the putValues(Map<String, Object> map, Record recordObj) is called.\r\n\r\nIn this method the recordObj.getColumns() is called to retrieve the available columns of the record. The columns are iterated over to retrieve the respective values.\r\n\r\nWhen a fixed with file with the following example.pzmap.xml scheme was parsed, \r\n\r\n \r\n{code:java}\r\n<?xml version='1.0'?>\r\n<!-- DTD can be pulled from the Jar or over the web-->\r\n<!DOCTYPE PZMAP SYSTEM\t\"flatpack.dtd\" >\r\n<!--<!DOCTYPE PZMAP SYSTEM\t\"http://flatpack.sourceforge.net/flatpack.dtd\" >-->\r\n<PZMAP>\r\n    <RECORD id=\"header\" indicator=\"0\" elementNumber=\"1\">\r\n        <COLUMN name=\"RECORDINDICATOR\" length=\"5\" />\r\n        <COLUMN name=\"HEADERDATA\" length=\"20\" />\r\n    </RECORD> \r\n        <COLUMN name=\"FIRSTNAME\" length=\"35\" />\r\n\t<COLUMN name=\"LASTNAME\" length=\"35\" />\r\n\t<COLUMN name=\"ADDRESS\" length=\"100\" />\r\n\t<COLUMN name=\"CITY\" length=\"100\" />\r\n\t<COLUMN name=\"STATE\" length=\"2\" />\r\n\t<COLUMN name=\"ZIP\" length=\"5\" />\r\n    <RECORD id=\"trailer\" indicator=\"9\" elementNumber=\"1\">\r\n        <COLUMN name=\"RECORDINDICATOR\" length=\"5\" />\r\n        <COLUMN name=\"TRAILERDATA\" length=\"15\" />\r\n    </RECORD>\r\n\t\t\r\n</PZMAP>  {code}\r\nthis leads to the following error being thrown: \r\n\r\n \r\n{code:java}\r\njava.util.NoSuchElementException: Column [FIRSTNAME] does not exist, check case/spelling. key:[header] at net.sf.flatpack.util.ParserUtils.getColumnIndex(ParserUtils.java:618) at net.sf.flatpack.RowRecord.getStringValue(RowRecord.java:269) at net.sf.flatpack.RowRecord.getString(RowRecord.java:315) at org.apache.camel.component.flatpack.FlatpackConverter.putValues(FlatpackConverter.java:117) at org.apache.camel.component.flatpack.FlatpackConverter.toMap(FlatpackConverter.java:48) at org.apache.camel.component.flatpack.DataSetList$1.next(DataSetList.java:90) at org.apache.camel.component.flatpack.DataSetList$1.next(DataSetList.java:68) {code}\r\n \r\n\r\n \r\n\r\n*Error explanation*\r\n\r\nThe first record is the header record, which differs from the rows below. But the recordObj.getColumns() method retrieves not the header records columns (RECORDINDICATOR, HEADERDATA), but the other rows columns (FIRSTNAME, LASTNAME, ADDRESS, CITY, STATE, ZIP), which do not match the record structure. This leads to error.\r\n\r\n \r\n\r\n*Solution Suggestion*\r\n * use the local getColumns(DataSet dataSet) method instead of recordObj.getColumns() to retrieve the correct colums\r\n * change the getColumns(DataSet dataSet) methods signature to getColumns(Record dataSet)\r\n\r\n \r\n{code:java}\r\nprivate static void putValues(Map<String, Object> map, net.sf.flatpack.Record recordObj) {\r\n    String[] columns = getColumns(recordObj); // !!!modified!!!\r\n    for (String column : columns) {\r\n        String value = recordObj.getString(column);\r\n        map.put(column, value);\r\n    }\r\n}\r\n\r\nprivate static String[] getColumns(Record dataSet) { // !!!modified!!!\r\n    // the columns can vary depending on header, body or trailer\r\n    if (dataSet.isRecordID(FlatpackComponent.HEADER_ID)) {\r\n        return dataSet.getColumns(FlatpackComponent.HEADER_ID);\r\n    } else if (dataSet.isRecordID(FlatpackComponent.TRAILER_ID)) {\r\n        return dataSet.getColumns(FlatpackComponent.TRAILER_ID);\r\n    } else {\r\n        return dataSet.getColumns();\r\n    }\r\n} {code}\r\n \r\n\r\n \r\n\r\n ", "customfield_10010": null, "timetracking": {}, "customfield_12314523": null, "customfield_12314127": null, "customfield_12314522": null, "customfield_12314126": null, "customfield_12314521": null, "customfield_12314125": null, "customfield_12314520": null, "customfield_12314124": null, "customfield_12312340": null, "attachment": [], "customfield_12314123": null, "customfield_12312341": null, "customfield_12312220": null, "customfield_12314122": null, "customfield_12314121": null, "customfield_12310041": null, "customfield_12314120": null, "customfield_12314129": null, "customfield_12314524": null, "customfield_12314128": null, "summary": "flatpack converter accesses invalid column names for header and trailer record value retrieval of fixed width files", "customfield_12314130": null, "customfield_12310291": null, "customfield_12310290": null, "customfield_12311024": null, "customfield_12314138": null, "customfield_12314137": null, "environment": "* probably all\r\n * discovered on camel 4 quarkus (after migrating from camel 2 fuse)\r\n ** quarkus-camel-bom, quarkus-bom version: 3.16.2", "customfield_12314136": null, "customfield_12314135": null, "customfield_12311020": null, "customfield_12314134": null, "duedate": null, "customfield_12314132": null, "customfield_12314131": null, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13630049/comment/18023475", "id": "18023475", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=davsclaus", "name": "davsclaus", "key": "davsclaus", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"}, "displayName": "Claus Ibsen", "active": true, "timeZone": "Europe/Berlin"}, "body": "You are welcome to work on a patch and send a PR", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=davsclaus", "name": "davsclaus", "key": "davsclaus", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"}, "displayName": "Claus Ibsen", "active": true, "timeZone": "Europe/Berlin"}, "created": "2025-09-29T05:09:41.977+0000", "updated": "2025-09-29T05:09:41.977+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13630049/comment/18028062", "id": "18028062", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=davsclaus", "name": "davsclaus", "key": "davsclaus", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"}, "displayName": "Claus Ibsen", "active": true, "timeZone": "Europe/Berlin"}, "body": "Thanks for reporting and the suggested fix", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=davsclaus", "name": "davsclaus", "key": "davsclaus", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=davsclaus&avatarId=15835", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=davsclaus&avatarId=15835", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=davsclaus&avatarId=15835", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=davsclaus&avatarId=15835"}, "displayName": "Claus Ibsen", "active": true, "timeZone": "Europe/Berlin"}, "created": "2025-10-07T12:06:54.749+0000", "updated": "2025-10-07T12:06:54.749+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "customfield_12311820": "0|z1xvz4:", "customfield_12314139": null}}