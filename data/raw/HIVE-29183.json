{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13628458", "self": "https://issues.apache.org/jira/rest/api/2/issue/13628458", "key": "HIVE-29183", "fields": {"fixVersions": [], "resolution": null, "customfield_12312322": null, "customfield_12312323": null, "customfield_12310420": "9223372036854775807", "customfield_12312320": null, "customfield_12312321": null, "customfield_12312328": null, "customfield_12312329": null, "customfield_12312326": null, "customfield_12310300": null, "customfield_12312327": null, "customfield_12312324": null, "customfield_12312720": null, "customfield_12312325": null, "lastViewed": null, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "labels": ["pull-request-available"], "customfield_12312333": null, "customfield_12312334": null, "customfield_12313422": "false", "customfield_12310310": "1.0", "customfield_12312331": null, "customfield_12312332": null, "aggregatetimeoriginalestimate": null, "timeestimate": null, "customfield_12312330": null, "versions": [], "customfield_12311120": null, "customfield_12313826": null, "issuelinks": [], "customfield_12312339": null, "customfield_12313825": null, "assignee": null, "customfield_12312337": null, "customfield_12313823": null, "customfield_12312338": null, "customfield_12311920": null, "customfield_12313822": null, "customfield_12312335": null, "customfield_12313821": null, "customfield_12312336": null, "customfield_12313820": null, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}, "components": [{"self": "https://issues.apache.org/jira/rest/api/2/component/12325007", "id": "12325007", "name": "Hive"}, {"self": "https://issues.apache.org/jira/rest/api/2/component/12338615", "id": "12338615", "name": "Iceberg integration"}, {"self": "https://issues.apache.org/jira/rest/api/2/component/12315100", "id": "12315100", "name": "SQL", "description": "Issues related to Hive Query Language and its conformance with ANSI SQL."}], "archiveddate": null, "customfield_12312026": null, "customfield_12312023": null, "customfield_12312024": null, "aggregatetimeestimate": null, "customfield_12312022": null, "customfield_12310921": null, "customfield_12310920": "9223372036854775807", "customfield_12312823": null, "creator": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dkuzmenko", "name": "dkuzmenko", "key": "dkuzmenko", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Denys Kuzmenko", "active": true, "timeZone": "Etc/UTC"}, "subtasks": [{"id": "13628459", "key": "HIVE-29184", "self": "https://issues.apache.org/jira/rest/api/2/issue/13628459", "fields": {"summary": "Basic Variant type support in Hive", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/7", "id": "7", "description": "The sub-task of the issue", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype", "name": "Sub-task", "subtask": true, "avatarId": 21146}}}, {"id": "13632309", "key": "HIVE-29287", "self": "https://issues.apache.org/jira/rest/api/2/issue/13632309", "fields": {"summary": "Variant Shredding", "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/3", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/major.svg", "name": "Major", "id": "3"}, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/7", "id": "7", "description": "The sub-task of the issue", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21146&avatarType=issuetype", "name": "Sub-task", "subtask": true, "avatarId": 21146}}}], "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dkuzmenko", "name": "dkuzmenko", "key": "dkuzmenko", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Denys Kuzmenko", "active": true, "timeZone": "Etc/UTC"}, "aggregateprogress": {"progress": 0, "total": 0}, "customfield_12313520": null, "customfield_12310250": null, "progress": {"progress": 0, "total": 0}, "customfield_12313924": null, "votes": {"self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-29183/votes", "votes": 0, "hasVoted": false}, "worklog": {"startAt": 0, "maxResults": 20, "total": 0, "worklogs": []}, "archivedby": null, "customfield_12313920": null, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/2", "id": "2", "description": "A new feature of the product, which has yet to be developed.", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21141&avatarType=issuetype", "name": "New Feature", "subtask": false, "avatarId": 21141}, "timespent": null, "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@57465468[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3ac2c6ae[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@4ef32f36[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@622867f0[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3ab768d4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@fa82e5d[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@58f53a01[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@79c3d108[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7833f72c[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@36a7f4b1[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@47f3f556[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@205f3731[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}", "customfield_12314141": null, "customfield_12314140": null, "project": {"self": "https://issues.apache.org/jira/rest/api/2/project/12310843", "id": "12310843", "key": "HIVE", "name": "Hive", "projectTypeKey": "software", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310843&avatarId=11935", "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310843&avatarId=11935", "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310843&avatarId=11935", "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310843&avatarId=11935"}, "projectCategory": {"self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10292", "id": "10292", "description": "Scalable Distributed Computing", "name": "Hadoop"}}, "aggregatetimespent": null, "customfield_12312520": null, "customfield_12312521": "Fri Sep 12 18:27:42 UTC 2025", "customfield_12314422": null, "customfield_12314421": null, "customfield_12314146": null, "customfield_12314420": null, "customfield_12314145": null, "customfield_12314144": null, "customfield_12314143": null, "resolutiondate": null, "workratio": -1, "customfield_12312923": null, "customfield_12312920": null, "customfield_12312921": null, "watches": {"self": "https://issues.apache.org/jira/rest/api/2/issue/HIVE-29183/watchers", "watchCount": 3, "isWatching": false}, "created": "2025-09-09T08:21:40.000+0000", "customfield_12310192": null, "customfield_12310191": null, "customfield_12310230": null, "updated": "2025-09-16T12:15:15.000+0000", "timeoriginalestimate": null, "description": "A variant is a value that stores semi-structured data. The structure and data types in a variant are not necessarily consistent across rows in a table or data file. The variant type and binary encoding are defined in the Parquet project, with support currently available for V1. Support for Variant is added in Iceberg v3.\r\n\r\nVariants are similar to JSON with a wider set of primitive values including date, timestamp, timestamptz, binary, and decimals.\r\n\r\nVariant values may contain nested types:\r\n\r\n* An array is an ordered collection of variant values.\r\n* An object is a collection of fields that are a string key and a variant value.\r\nAs a semi-structured type, there are important differences between variant and Iceberg's other types:\r\n\r\n* Variant arrays are similar to lists, but may contain any variant value rather than a fixed element type.\r\n* Variant objects are similar to structs, but may contain variable fields identified by name and field values may be any variant value rather than a fixed field type.\r\n\r\nVariant data types allow for the efficient binary encoding of dynamic semi-structured data such as JSON, Avro, Parquet, etc. By encoding semi-structured data as a variant column, we retain the flexibility of the source data, while allowing query engines to more efficiently operate on the data.\r\n\r\nWith the support of Variant type, such data can be encoded in an efficient binary representation internally for better performance. Without that, we need to parse the data in its format inefficiently.\r\n\r\nThis will allow the following use cases:\r\n\r\n* Create an Iceberg table with a Variant column\r\nCREATE TABLE IF NOT EXISTS car_sales(record Variant);\r\n* Insert semi-structured data into the Variant column\r\nINSERT INTO car_sales SELECT PARSE_JSON(<json_string>)\r\n* Query against the semi-structured data\r\nSELECT VARIANT_GET(record, '$.dealer.ship', 'string') FROM car_sales\r\n\r\n\r\nVariant Binary Encoding\r\nhttps://github.com/apache/parquet-format/blob/master/VariantEncoding.md\r\n\r\nIceberg's Variant type proposal:\r\nhttps://docs.google.com/document/d/1sq70XDiWJ2DemWyA5dVB80gKzwi0CWoM0LOWM7VJVd8", "customfield_10010": null, "timetracking": {}, "customfield_12314523": null, "customfield_12314127": null, "customfield_12314522": null, "customfield_12314126": null, "customfield_12314521": null, "customfield_12314125": null, "customfield_12310320": null, "customfield_12314520": null, "customfield_12314124": null, "customfield_12312340": null, "attachment": [{"self": "https://issues.apache.org/jira/rest/api/2/attachment/13078312", "id": "13078312", "filename": "Iceberg Variant DataType in Hive.pdf", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ayushtkn", "name": "ayushtkn", "key": "ayushtkn", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Ayush Saxena", "active": true, "timeZone": "Asia/Kolkata"}, "created": "2025-09-09T12:18:47.732+0000", "size": 250132, "mimeType": "application/pdf", "content": "https://issues.apache.org/jira/secure/attachment/13078312/Iceberg+Variant+DataType+in+Hive.pdf"}], "customfield_12314123": null, "customfield_12312341": null, "customfield_12312220": null, "customfield_12314122": null, "customfield_12314121": null, "customfield_12314120": null, "customfield_12314129": null, "customfield_12314524": null, "customfield_12314128": null, "summary": "Integrating Variant Type into Hive", "customfield_12314130": null, "customfield_12310291": null, "customfield_12310290": null, "customfield_12311024": null, "customfield_12314138": null, "customfield_12314137": null, "environment": null, "customfield_12314136": null, "customfield_12314135": null, "customfield_12311020": null, "customfield_12314134": null, "duedate": null, "customfield_12314132": null, "customfield_12314131": null, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13628458/comment/18019139", "id": "18019139", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ayushtkn", "name": "ayushtkn", "key": "ayushtkn", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Ayush Saxena", "active": true, "timeZone": "Asia/Kolkata"}, "body": "I & [~dkuzmenko]  been discussing around the implementation. I have attached a quick doc on how I initially thought it could look like and a link to the POC around that ([GitHub Pull Request #6069|https://github.com/apache/hive/pull/6069])\r\n\r\nMy Initial hack was like Variant can internally be a Struct with two Fixed binary fields & I handled it that way in the POC. Denys while exploring found out that we have engines using dedicated class implementation for the Variant type. Flink, Trino & Spark I believe. \r\n\r\nSo, it would be better if we can also go with that approach, rather than Struct with two fields internally, we have a BinaryVariant/Variant Class which stores the metadata and value binary & we can use that class.\r\n\r\nThe POC PR, doesn't have that, We plan to extend that. Rest demonstrates a basic functionality we expect in the Phase-1\r\n\r\nA sample output can be seen here in the PR q.out file\r\n\r\n[https://github.com/apache/hive/pull/6069/files#diff-4b0500edafc601566ef37aa94c5bb704ed30a00f0461d26373c59501c4972b40]\r\n\r\n \r\n\r\nOpen to more suggestions/recommendation from other folks :) ", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=ayushtkn", "name": "ayushtkn", "key": "ayushtkn", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Ayush Saxena", "active": true, "timeZone": "Asia/Kolkata"}, "created": "2025-09-09T12:24:27.818+0000", "updated": "2025-09-09T12:24:27.818+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13628458/comment/18019927", "id": "18019927", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dkuzmenko", "name": "dkuzmenko", "key": "dkuzmenko", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Denys Kuzmenko", "active": true, "timeZone": "Etc/UTC"}, "body": "PR is ready for review. \r\nWe probably shouldn’t reference the JIRA id from the main ticket, as it doesn’t yet cover some features like shredding\r\n", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=dkuzmenko", "name": "dkuzmenko", "key": "dkuzmenko", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "Denys Kuzmenko", "active": true, "timeZone": "Etc/UTC"}, "created": "2025-09-12T18:27:42.084+0000", "updated": "2025-09-12T18:27:42.084+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "customfield_12311820": "0|z1xm5k:", "customfield_12314139": null}}