{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13630773", "self": "https://issues.apache.org/jira/rest/api/2/issue/13630773", "key": "ZOOKEEPER-4985", "fields": {"fixVersions": [], "resolution": null, "customfield_12312322": null, "customfield_12312323": null, "customfield_12310420": "9223372036854775807", "customfield_12312320": null, "customfield_12312321": null, "customfield_12312328": null, "customfield_12312329": null, "customfield_12312326": null, "customfield_12310300": null, "customfield_12312327": null, "customfield_12312324": null, "customfield_12312720": null, "customfield_12312325": null, "lastViewed": null, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "labels": ["pull-request-available"], "customfield_12312333": null, "customfield_12312334": null, "customfield_12313422": "false", "customfield_12310310": "0.0", "customfield_12312331": null, "customfield_12312332": null, "aggregatetimeoriginalestimate": null, "timeestimate": 0, "customfield_12312330": null, "versions": [{"self": "https://issues.apache.org/jira/rest/api/2/version/12355230", "id": "12355230", "description": "", "name": "3.9.4", "archived": false, "released": true, "releaseDate": "2025-08-29"}], "customfield_12311120": null, "customfield_12313826": null, "issuelinks": [], "customfield_12312339": null, "customfield_12313825": null, "assignee": null, "customfield_12312337": null, "customfield_12313823": null, "customfield_12312338": null, "customfield_12311920": null, "customfield_12313822": null, "customfield_12312335": null, "customfield_12313821": null, "customfield_12312336": null, "customfield_12313820": null, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/1", "description": "The issue is open and ready for the assignee to start work on it.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/open.png", "name": "Open", "id": "1", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/2", "id": 2, "key": "new", "colorName": "blue-gray", "name": "To Do"}}, "components": [], "archiveddate": null, "customfield_12312026": null, "customfield_12312023": null, "customfield_12312024": null, "aggregatetimeestimate": 0, "customfield_12312022": null, "customfield_12310921": null, "customfield_12310920": "9223372036854775807", "customfield_12312823": null, "creator": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=larsfrancke", "name": "larsfrancke", "key": "lars_francke", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"}, "displayName": "Lars Francke", "active": true, "timeZone": "Europe/Berlin"}, "subtasks": [], "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=larsfrancke", "name": "larsfrancke", "key": "lars_francke", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=lars_francke&avatarId=24833", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=lars_francke&avatarId=24833", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=lars_francke&avatarId=24833", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=lars_francke&avatarId=24833"}, "displayName": "Lars Francke", "active": true, "timeZone": "Europe/Berlin"}, "aggregateprogress": {"progress": 1200, "total": 1200, "percent": 100}, "customfield_12313520": null, "customfield_12310250": null, "progress": {"progress": 1200, "total": 1200, "percent": 100}, "customfield_12313924": null, "votes": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4985/votes", "votes": 0, "hasVoted": false}, "worklog": {"startAt": 0, "maxResults": 20, "total": 2, "worklogs": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13630773/worklog/985947", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "lfrancke opened a new pull request, #2324:\nURL: https://github.com/apache/zookeeper/pull/2324\n\n   https://issues.apache.org/jira/browse/ZOOKEEPER-4985\r\n   \r\n   The zkCleanup.sh script has several issues that make it difficult to use in containerized or non-standard deployments:\r\n   \r\n   The script hardcodes the path to zoo.cfg and fails with confusing error messages when the config file is not in the default location. When the config file is missing, it passes empty strings to PurgeTxnLog, causing confusing error messages\r\n   \r\n   Steps to Reproduce:\r\n   \r\n   * Run ZooKeeper with config in a non-standard location (e.g., /custom/path/zoo.cfg)\r\n   * Try to run cleanup:\r\n   \r\n   ```\r\n   grep: /path/to/zookeeper/bin/../conf/zoo.cfg: No such file or directory\r\n   grep: /path/to/zookeeper/bin/../conf/zoo.cfg: No such file or directory\r\n   Path '/path/to/zookeeper/bin' does not exist.\r\n   Usage:\r\n   PurgeTxnLog dataLogDir [snapDir] -n count \r\n   ```\n\n\n", "created": "2025-10-06T14:56:26.557+0000", "updated": "2025-10-06T14:56:26.557+0000", "started": "2025-10-06T14:56:26.556+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "985947", "issueId": "13630773"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13630773/worklog/985948", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "lfrancke commented on PR #2324:\nURL: https://github.com/apache/zookeeper/pull/2324#issuecomment-3372161345\n\n   The shellcheck failures were there before already.\n\n\n", "created": "2025-10-06T15:01:03.088+0000", "updated": "2025-10-06T15:01:03.088+0000", "started": "2025-10-06T15:01:03.087+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "985948", "issueId": "13630773"}]}, "archivedby": null, "customfield_12313920": null, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/1", "id": "1", "description": "A problem which impairs or prevents the functions of the product.", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype", "name": "Bug", "subtask": false, "avatarId": 21133}, "timespent": 1200, "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@50f479[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@221c0c0d[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@474d32df[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@573325f[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@1bb830c7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@14223bb0[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3a573821[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@26aa14fe[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7cce26e4[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@79b46d76[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@7aa1d451[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@cda321f[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}", "customfield_12314141": null, "customfield_12314140": null, "project": {"self": "https://issues.apache.org/jira/rest/api/2/project/12310801", "id": "12310801", "key": "ZOOKEEPER", "name": "ZooKeeper", "projectTypeKey": "software", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011", "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011", "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011", "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"}, "projectCategory": {"self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10484", "id": "10484", "description": "Apache ZooKeeper related", "name": "ZooKeeper"}}, "aggregatetimespent": 1200, "customfield_12312520": null, "customfield_12312521": "2025-10-06 13:01:54.0", "customfield_12314422": null, "customfield_12314421": null, "customfield_12314146": null, "customfield_12314420": null, "customfield_12314145": null, "customfield_12314144": null, "customfield_12314143": null, "resolutiondate": null, "workratio": -1, "customfield_12312923": null, "customfield_12312920": null, "customfield_12312921": null, "watches": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4985/watchers", "watchCount": 1, "isWatching": false}, "created": "2025-10-06T13:01:54.000+0000", "customfield_12310192": null, "customfield_12310191": null, "customfield_12310230": null, "updated": "2025-10-06T15:01:03.000+0000", "timeoriginalestimate": null, "description": "The zkCleanup.sh script has several issues that make it difficult to use in containerized or non-standard deployments:\r\n # The script hardcodes the path to zoo.cfg and fails with confusing error messages when the config file is not in the default location\r\n # Unlike other ZooKeeper scripts, it doesn't properly support the --config flag even though zkEnv.sh supports it\r\n # When the config file is missing, it passes empty strings to PurgeTxnLog, causing confusing error messages\r\n\r\nSteps to Reproduce:\r\n * Run ZooKeeper with config in a non-standard location (e.g., /custom/path/zoo.cfg)\r\n * Try to run cleanup:\r\n\r\n{code:java}\r\n  grep: /path/to/zookeeper/bin/../conf/zoo.cfg: No such file or directory\r\n  grep: /path/to/zookeeper/bin/../conf/zoo.cfg: No such file or directory\r\n  Path '/path/to/zookeeper/bin' does not exist.\r\n  Usage:\r\n  PurgeTxnLog dataLogDir [snapDir] -n count {code}\r\n * Trying to use --config flag (which works for zkServer.sh) has no effect either\r\n\r\n \r\n\r\nThe reason, I believe, is that if the config can't be found empty strings will be passed to `PurgeTxnLogs` and that fails.\r\n\r\n \r\n\r\nI'll raise a PR for this.\r\n\r\n ", "customfield_10010": null, "timetracking": {"remainingEstimate": "0h", "timeSpent": "20m", "remainingEstimateSeconds": 0, "timeSpentSeconds": 1200}, "customfield_12314523": null, "customfield_12314127": null, "customfield_12314522": null, "customfield_12314126": null, "customfield_12314521": null, "customfield_12314125": null, "customfield_12314520": null, "customfield_12314124": null, "customfield_12312340": null, "attachment": [], "customfield_12314123": null, "customfield_12312341": null, "customfield_12312220": null, "customfield_12314122": null, "customfield_12314121": null, "customfield_12314120": null, "customfield_12314129": null, "customfield_12314524": null, "customfield_12314128": null, "summary": "zkCleanup.sh fails for non-standard config directories", "customfield_12314130": null, "customfield_12310291": null, "customfield_12310290": null, "customfield_12311024": null, "customfield_12314138": null, "customfield_12314137": null, "environment": null, "customfield_12314136": null, "customfield_12314135": null, "customfield_12311020": null, "customfield_12314134": null, "duedate": null, "customfield_12314132": null, "customfield_12314131": null, "comment": {"comments": [], "maxResults": 0, "total": 0, "startAt": 0}, "customfield_12311820": "0|z1y0fs:", "customfield_12314139": null}}