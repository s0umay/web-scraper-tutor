{"expand": "operations,versionedRepresentations,editmeta,changelog,renderedFields", "id": "13596328", "self": "https://issues.apache.org/jira/rest/api/2/issue/13596328", "key": "ZOOKEEPER-4880", "fields": {"fixVersions": [{"self": "https://issues.apache.org/jira/rest/api/2/version/12353481", "id": "12353481", "name": "3.10.0", "archived": false, "released": false}], "resolution": {"self": "https://issues.apache.org/jira/rest/api/2/resolution/1", "id": "1", "description": "A fix for this issue is checked into the tree and tested.", "name": "Fixed"}, "customfield_12312322": null, "customfield_12312323": null, "customfield_12310420": "9223372036854775807", "customfield_12312320": null, "customfield_12312321": null, "customfield_12312328": null, "customfield_12312329": null, "customfield_12312326": null, "customfield_12310300": null, "customfield_12312327": null, "customfield_12312324": null, "customfield_12312720": null, "customfield_12312325": null, "lastViewed": null, "priority": {"self": "https://issues.apache.org/jira/rest/api/2/priority/4", "iconUrl": "https://issues.apache.org/jira/images/icons/priorities/minor.svg", "name": "Minor", "id": "4"}, "labels": ["pull-request-available"], "customfield_12312333": null, "customfield_12312334": null, "customfield_12313422": "false", "customfield_12310310": "0.0", "customfield_12312331": null, "customfield_12312332": null, "aggregatetimeoriginalestimate": null, "timeestimate": 0, "customfield_12312330": null, "versions": [], "customfield_12311120": null, "customfield_12313826": null, "issuelinks": [], "customfield_12312339": null, "customfield_12313825": null, "assignee": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=luozongle01", "name": "luozongle01", "key": "JIRAUSER307443", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER307443&avatarId=53836", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER307443&avatarId=53836", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER307443&avatarId=53836", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER307443&avatarId=53836"}, "displayName": "luozongle", "active": true, "timeZone": "Asia/Shanghai"}, "customfield_12312337": null, "customfield_12313823": null, "customfield_12312338": null, "customfield_12311920": null, "customfield_12313822": null, "customfield_12312335": null, "customfield_12313821": null, "customfield_12312336": null, "customfield_12313820": null, "status": {"self": "https://issues.apache.org/jira/rest/api/2/status/5", "description": "A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.", "iconUrl": "https://issues.apache.org/jira/images/icons/statuses/resolved.png", "name": "Resolved", "id": "5", "statusCategory": {"self": "https://issues.apache.org/jira/rest/api/2/statuscategory/3", "id": 3, "key": "done", "colorName": "green", "name": "Done"}}, "components": [{"self": "https://issues.apache.org/jira/rest/api/2/component/12312385", "id": "12312385", "name": "jute", "description": "Data marshalling code generator for ZooKeeper"}], "archiveddate": null, "customfield_12312026": null, "customfield_12312023": null, "customfield_12312024": null, "aggregatetimeestimate": 0, "customfield_12312022": null, "customfield_12310921": null, "customfield_12310920": "9223372036854775807", "customfield_12312823": null, "creator": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=luozongle01", "name": "luozongle01", "key": "JIRAUSER307443", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER307443&avatarId=53836", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER307443&avatarId=53836", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER307443&avatarId=53836", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER307443&avatarId=53836"}, "displayName": "luozongle", "active": true, "timeZone": "Asia/Shanghai"}, "subtasks": [], "reporter": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=luozongle01", "name": "luozongle01", "key": "JIRAUSER307443", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=JIRAUSER307443&avatarId=53836", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=JIRAUSER307443&avatarId=53836", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=JIRAUSER307443&avatarId=53836", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=JIRAUSER307443&avatarId=53836"}, "displayName": "luozongle", "active": true, "timeZone": "Asia/Shanghai"}, "aggregateprogress": {"progress": 27600, "total": 27600, "percent": 100}, "customfield_12313520": null, "customfield_12310250": null, "progress": {"progress": 27600, "total": 27600, "percent": 100}, "customfield_12313924": null, "votes": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4880/votes", "votes": 1, "hasVoted": false}, "worklog": {"startAt": 0, "maxResults": 20, "total": 46, "worklogs": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/939729", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 opened a new pull request, #2206:\nURL: https://github.com/apache/zookeeper/pull/2206\n\n   Generate comments from zookeeper.jute into code: https://issues.apache.org/jira/browse/ZOOKEEPER-4880\r\n   \r\n   ## Brief Description\r\n   Support generating end-of-line comments and class comments in `zookeeper.jute` into code.\r\n   \r\n   \r\n   ## How to test this change\r\n   1. By comparing the `zookeeper-jute/target/generated-sources/java/org/apache/zookeeper` and `zookeeper-client/zookeeper-client-c/generated` directories before and after the modification, there are no other differences except the comments.\r\n   <img width=\"1440\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9bd4b5da-f969-4cbe-b77c-d8b16385d4ec\">\r\n   <img width=\"1440\" alt=\"image\" src=\"https://github.com/user-attachments/assets/eb4c764d-d1b7-4c41-97ee-27221bf13229\">\r\n   \r\n   <br>\r\n   <br>\r\n   2. When the test class has multiple lines of comments, the comments can be generated normally.\r\n   <img width=\"1440\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a9decd1d-9717-4eaa-8c9a-85762899469c\">\r\n   \r\n   <br>\r\n   <br>\r\n   3. Testing vector type properties can generate comments normally.\r\n   <img width=\"1386\" alt=\"image\" src=\"https://github.com/user-attachments/assets/89f7db00-252f-4f0c-85cd-68d6e87d2c77\">\r\n   \r\n   <br>\r\n   <br>\r\n   4. Testing class type properties can generate comments normally\r\n   <img width=\"1407\" alt=\"image\" src=\"https://github.com/user-attachments/assets/0d094349-f47b-4425-9426-378156599d85\">\r\n   \r\n   <br>\r\n   <br>\r\n   5. Testing comments that do not meet expectations will not generate comments and will not affect the generation of normal code.\r\n   <img width=\"1401\" alt=\"image\" src=\"https://github.com/user-attachments/assets/f5f47605-9faa-4a89-ac80-2c7e3f1e1535\">\r\n   \n\n\n", "created": "2024-10-23T15:04:22.804+0000", "updated": "2024-10-23T15:04:22.804+0000", "started": "2024-10-23T15:04:22.804+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "939729", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/939747", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2432773020\n\n   @kezhuw  Could you help me take a look? Thanks.\r\n   \r\n   \n\n\n", "created": "2024-10-23T16:19:09.774+0000", "updated": "2024-10-23T16:19:09.774+0000", "started": "2024-10-23T16:19:09.773+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "939747", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/940344", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1818339448\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +780,30 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    protected String getRecordComments() {\n+        if (mRecordToken == null || mRecordToken.specialToken == null) {\n+            return null;\n+        }\n+\n+        StringJoiner joiner = new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\");\n+        Token tmpTkn = mRecordToken.specialToken;\n+        while (tmpTkn.specialToken != null) {\n+            tmpTkn = tmpTkn.specialToken;\n+        }\n+\n+        while (tmpTkn != null) {\n+            String image = tmpTkn.image.trim();\n+            tmpTkn = tmpTkn.next;\n+            if (image.startsWith(\"//\")) {\n\nReview Comment:\n   The capture does not shaped well for directly usage. I tasted the following capture, and it captured a complete line comment. This way we can output whatever it captured without post work.\r\n   \r\n   ```\r\n   SPECIAL_TOKEN :\r\n   {\r\n     <SINGLE_LINE_COMMENT: \"//\" (~[\"\\n\",\"\\r\"])* (\"\\n\"|\"\\r\"|\"\\r\\n\")>\r\n   }\r\n   ```\r\n   \r\n   See also https://javacc.github.io/javacc/tutorials/token-manager.html\n\n\n\n", "created": "2024-10-28T03:56:18.117+0000", "updated": "2024-10-28T03:56:18.117+0000", "started": "2024-10-28T03:56:18.116+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "940344", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/940350", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1818365785\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +780,30 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    protected String getRecordComments() {\n+        if (mRecordToken == null || mRecordToken.specialToken == null) {\n+            return null;\n+        }\n+\n+        StringJoiner joiner = new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\");\n+        Token tmpTkn = mRecordToken.specialToken;\n+        while (tmpTkn.specialToken != null) {\n+            tmpTkn = tmpTkn.specialToken;\n+        }\n+\n+        while (tmpTkn != null) {\n+            String image = tmpTkn.image.trim();\n+            tmpTkn = tmpTkn.next;\n+            if (image.startsWith(\"//\")) {\n\nReview Comment:\n   Thank you very much for your comment. I will make some further modifications.ðŸ˜†\n\n\n\n", "created": "2024-10-28T04:40:04.127+0000", "updated": "2024-10-28T04:40:04.127+0000", "started": "2024-10-28T04:40:04.127+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "940350", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/940821", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2445635303\n\n   Hi, @kezhuw, I made some modifications, thank you for your review last time. I feel much better now than last time. \r\n   I hope you can help me look again.\r\n   \r\n   Currently, multi-line comments and single-line comments are supported.\r\n   \r\n   I put `JField` or `JRecord` into a `TreeSet`, so that I can get the `line` or `column` information of the previous or next element. According to the `beginLine`, `beginColumn`, `endLine`, `endColumn` information, I determine the range of my comment area, and then format the output in line number order.\r\n   \r\n   Here is my testing process.\r\n   1. Verify that the modification only affects the comments and does not affect the normal code.\r\n   \r\n   2. When verifying that each JField is on its own line, multi-line comments and single-line comments are generated normally.\r\n   <img width=\"1317\" alt=\"image\" src=\"https://github.com/user-attachments/assets/28f797ca-f474-46d0-b178-f3a7abb5faf4\">\r\n   <img width=\"1388\" alt=\"image\" src=\"https://github.com/user-attachments/assets/4e9fce69-3c38-4698-ac90-24882eea6196\">\r\n   \r\n   3. If the attributes are on the same line, the comment should belong to the previous Field.\r\n   <img width=\"1402\" alt=\"image\" src=\"https://github.com/user-attachments/assets/77120d53-9f8b-4323-9cad-485d58f97aef\">\r\n   \r\n   \n\n\n", "created": "2024-10-30T01:35:02.900+0000", "updated": "2024-10-30T01:35:02.900+0000", "started": "2024-10-30T01:35:02.900+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "940821", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/940823", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1821739303\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +780,30 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    protected String getRecordComments() {\n+        if (mRecordToken == null || mRecordToken.specialToken == null) {\n+            return null;\n+        }\n+\n+        StringJoiner joiner = new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\");\n+        Token tmpTkn = mRecordToken.specialToken;\n+        while (tmpTkn.specialToken != null) {\n+            tmpTkn = tmpTkn.specialToken;\n+        }\n+\n+        while (tmpTkn != null) {\n+            String image = tmpTkn.image.trim();\n+            tmpTkn = tmpTkn.next;\n+            if (image.startsWith(\"//\")) {\n\nReview Comment:\n   > The capture does not shaped well for directly usage. I tasted the following capture, and it captured a complete line comment. This way we can output whatever it captured without post work.\r\n   > \r\n   > ```\r\n   > SPECIAL_TOKEN :\r\n   > {\r\n   >   <SINGLE_LINE_COMMENT: \"//\" (~[\"\\n\",\"\\r\"])* (\"\\n\"|\"\\r\"|\"\\r\\n\")>\r\n   > }\r\n   > ```\r\n   > \r\n   > See also https://javacc.github.io/javacc/tutorials/token-manager.html\r\n   \r\n   It seems like there's no need to change this now, because I get all the commentsï¼Œthen I use and distinguished them by line numbe. ðŸ˜‚ðŸ˜‚\n\n\n\n", "created": "2024-10-30T01:42:26.294+0000", "updated": "2024-10-30T01:42:26.294+0000", "started": "2024-10-30T01:42:26.293+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "940823", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942299", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1832126265\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +790,53 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    private String getJavaFieldComments(JField jField) {\n+        StringJoiner javaFieldCommentsJoiner =\n+                new StringJoiner(\"\\n   * \", \"  /**\\n   * \", \"\\n   */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, javaFieldCommentsJoiner);\n+    }\n+\n+    private String getCFieldComments(JField jField) {\n+        StringJoiner cFieldCommentsJoiner =\n+                new StringJoiner(\"\\n     * \", \"    /**\\n     * \", \"\\n     */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, cFieldCommentsJoiner);\n+    }\n+\n+    private String getFieldComments(JField jField, StringJoiner fieldCommentsJoiner) {\n+        List<String> fieldSpecialToken = jCommentGenerator.getFieldCommentsList(jField);\n+        return getComments(fieldCommentsJoiner, fieldSpecialToken);\n+    }\n+\n+    private String getRecordComments() {\n+        List<String> classSpecialToken = jCommentGenerator.getRecordCommentsList(this);\n+\n+        StringJoiner recordCommentsJoiner =\n+                new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\").setEmptyValue(\"\");\n+        return getComments(recordCommentsJoiner, classSpecialToken);\n+    }\n+\n+    private static String getComments(StringJoiner commentsJoiner, List<String> commentList) {\n+        if (commentList == null || commentList.isEmpty()) {\n+            return commentsJoiner.toString();\n+        }\n+\n+        for (String commentMulti : commentList) {\n+            if (commentMulti == null || commentMulti.isEmpty()) {\n+                continue;\n+            }\n+\n+            String[] commentArray = commentMulti.split(\"\\n\");\n+            for (String comment : commentArray) {\n+\n+                comment = comment.replaceAll(\"//|/\\\\*\\\\*|/\\\\*|\\\\*\\\\*/|\\\\*/\", \"\")\n+                        .replaceAll(\"^[* ]+\", \"\").trim();\n+\n+                if (!comment.isEmpty()) {\n\nReview Comment:\n   The generated comments has no empty line which is not good.\n\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +790,53 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    private String getJavaFieldComments(JField jField) {\n+        StringJoiner javaFieldCommentsJoiner =\n+                new StringJoiner(\"\\n   * \", \"  /**\\n   * \", \"\\n   */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, javaFieldCommentsJoiner);\n+    }\n+\n+    private String getCFieldComments(JField jField) {\n+        StringJoiner cFieldCommentsJoiner =\n+                new StringJoiner(\"\\n     * \", \"    /**\\n     * \", \"\\n     */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, cFieldCommentsJoiner);\n+    }\n+\n+    private String getFieldComments(JField jField, StringJoiner fieldCommentsJoiner) {\n+        List<String> fieldSpecialToken = jCommentGenerator.getFieldCommentsList(jField);\n+        return getComments(fieldCommentsJoiner, fieldSpecialToken);\n+    }\n+\n+    private String getRecordComments() {\n+        List<String> classSpecialToken = jCommentGenerator.getRecordCommentsList(this);\n+\n+        StringJoiner recordCommentsJoiner =\n+                new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\").setEmptyValue(\"\");\n+        return getComments(recordCommentsJoiner, classSpecialToken);\n+    }\n+\n+    private static String getComments(StringJoiner commentsJoiner, List<String> commentList) {\n+        if (commentList == null || commentList.isEmpty()) {\n+            return commentsJoiner.toString();\n+        }\n+\n+        for (String commentMulti : commentList) {\n+            if (commentMulti == null || commentMulti.isEmpty()) {\n+                continue;\n+            }\n+\n+            String[] commentArray = commentMulti.split(\"\\n\");\n+            for (String comment : commentArray) {\n+\n+                comment = comment.replaceAll(\"//|/\\\\*\\\\*|/\\\\*|\\\\*\\\\*/|\\\\*/\", \"\")\n\nReview Comment:\n   I do think people will want to maintain this kind of code.\n\n\n\n", "created": "2024-11-07T06:44:16.435+0000", "updated": "2024-11-07T06:44:16.435+0000", "started": "2024-11-07T06:44:16.434+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942299", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942347", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2461577162\n\n   > @luozongle01 Thank you for your work!\r\n   > \r\n   > It might be late, I am sorry for this, but I think we probably should align on how comments from jute should be formatted in generated sources ? I see two approaches.\r\n   > \r\n   > 1. Keep it in origin format.\r\n   > 2. Transfer comments from one format to another.\r\n   > \r\n   > I saw this pr is going on the second approach. I am good to unify the generated comment format. But I think it could be challenge, as we should escape between two formats which could make generated comments strange/inaccurate.\r\n   > \r\n   > ```\r\n   >     // /**\r\n   >     //  * Some dead comments.\r\n   >     //  */\r\n   >     //\r\n   >     // Things changed. We are going ..\r\n   > ```\r\n   > \r\n   > Currently, the generated comments blindly strip some special strings. I don't think it is a good thing.\r\n   > \r\n   > I suggest we keep it simple and don't touch comment content, this is also a safe path. If we want javadoc style comments, I think it is ok to convert them manually.\r\n   \r\n   \r\n   \r\n   > @luozongle01 Thank you for your work!\r\n   > \r\n   > It might be late, I am sorry for this, but I think we probably should align on how comments from jute should be formatted in generated sources ? I see two approaches.\r\n   > \r\n   > 1. Keep it in origin format.\r\n   > 2. Transfer comments from one format to another.\r\n   > \r\n   > I saw this pr is going on the second approach. I am good to unify the generated comment format. But I think it could be challenge, as we should escape between two formats which could make generated comments strange/inaccurate.\r\n   > \r\n   > ```\r\n   >     // /**\r\n   >     //  * Some dead comments.\r\n   >     //  */\r\n   >     //\r\n   >     // Things changed. We are going ..\r\n   > ```\r\n   > \r\n   > Currently, the generated comments blindly strip some special strings. I don't think it is a good thing.\r\n   > \r\n   > I suggest we keep it simple and don't touch comment content, this is also a safe path. If we want javadoc style comments, I think it is ok to convert them manually.\r\n   \r\n   Thank you very much for your review. I really didn't consider that ðŸ˜‚ðŸ˜‚.   I will keep the original format output.\r\n   ï»¿\r\n   However, for the end-of-line comments, should I continue to keep them at the end of the line or is it better to move them above the code?\n\n\n", "created": "2024-11-07T08:10:24.569+0000", "updated": "2024-11-07T08:10:24.569+0000", "started": "2024-11-07T08:10:24.568+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942347", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942428", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2462189756\n\n   > for the end-of-line comments, should I continue to keep them at the end of the line or is it better to move them above the code?\r\n   \r\n   I prefer to move them above the code.\n\n\n", "created": "2024-11-07T13:04:32.921+0000", "updated": "2024-11-07T13:04:32.921+0000", "started": "2024-11-07T13:04:32.920+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942428", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942432", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2462204400\n\n   > > for the end-of-line comments, should I continue to keep them at the end of the line or is it better to move them above the code?\r\n   > \r\n   > I prefer to move them above the code.\r\n   \r\n   Thanks, I thought so too, I'll modify the code.\n\n\n", "created": "2024-11-07T13:11:34.486+0000", "updated": "2024-11-07T13:11:34.486+0000", "started": "2024-11-07T13:11:34.486+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942432", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942453", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1832739515\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +790,53 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    private String getJavaFieldComments(JField jField) {\n+        StringJoiner javaFieldCommentsJoiner =\n+                new StringJoiner(\"\\n   * \", \"  /**\\n   * \", \"\\n   */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, javaFieldCommentsJoiner);\n+    }\n+\n+    private String getCFieldComments(JField jField) {\n+        StringJoiner cFieldCommentsJoiner =\n+                new StringJoiner(\"\\n     * \", \"    /**\\n     * \", \"\\n     */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, cFieldCommentsJoiner);\n+    }\n+\n+    private String getFieldComments(JField jField, StringJoiner fieldCommentsJoiner) {\n+        List<String> fieldSpecialToken = jCommentGenerator.getFieldCommentsList(jField);\n+        return getComments(fieldCommentsJoiner, fieldSpecialToken);\n+    }\n+\n+    private String getRecordComments() {\n+        List<String> classSpecialToken = jCommentGenerator.getRecordCommentsList(this);\n+\n+        StringJoiner recordCommentsJoiner =\n+                new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\").setEmptyValue(\"\");\n+        return getComments(recordCommentsJoiner, classSpecialToken);\n+    }\n+\n+    private static String getComments(StringJoiner commentsJoiner, List<String> commentList) {\n+        if (commentList == null || commentList.isEmpty()) {\n+            return commentsJoiner.toString();\n+        }\n+\n+        for (String commentMulti : commentList) {\n+            if (commentMulti == null || commentMulti.isEmpty()) {\n+                continue;\n+            }\n+\n+            String[] commentArray = commentMulti.split(\"\\n\");\n+            for (String comment : commentArray) {\n+\n+                comment = comment.replaceAll(\"//|/\\\\*\\\\*|/\\\\*|\\\\*\\\\*/|\\\\*/\", \"\")\n\nReview Comment:\n   s/do/don't/\n\n\n\n", "created": "2024-11-07T14:06:03.541+0000", "updated": "2024-11-07T14:06:03.541+0000", "started": "2024-11-07T14:06:03.540+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942453", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942467", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1832790508\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +790,53 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    private String getJavaFieldComments(JField jField) {\n+        StringJoiner javaFieldCommentsJoiner =\n+                new StringJoiner(\"\\n   * \", \"  /**\\n   * \", \"\\n   */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, javaFieldCommentsJoiner);\n+    }\n+\n+    private String getCFieldComments(JField jField) {\n+        StringJoiner cFieldCommentsJoiner =\n+                new StringJoiner(\"\\n     * \", \"    /**\\n     * \", \"\\n     */\\n\").setEmptyValue(\"\");\n+        return getFieldComments(jField, cFieldCommentsJoiner);\n+    }\n+\n+    private String getFieldComments(JField jField, StringJoiner fieldCommentsJoiner) {\n+        List<String> fieldSpecialToken = jCommentGenerator.getFieldCommentsList(jField);\n+        return getComments(fieldCommentsJoiner, fieldSpecialToken);\n+    }\n+\n+    private String getRecordComments() {\n+        List<String> classSpecialToken = jCommentGenerator.getRecordCommentsList(this);\n+\n+        StringJoiner recordCommentsJoiner =\n+                new StringJoiner(\"\\n * \", \"/**\\n * \", \"\\n */\\n\").setEmptyValue(\"\");\n+        return getComments(recordCommentsJoiner, classSpecialToken);\n+    }\n+\n+    private static String getComments(StringJoiner commentsJoiner, List<String> commentList) {\n+        if (commentList == null || commentList.isEmpty()) {\n+            return commentsJoiner.toString();\n+        }\n+\n+        for (String commentMulti : commentList) {\n+            if (commentMulti == null || commentMulti.isEmpty()) {\n+                continue;\n+            }\n+\n+            String[] commentArray = commentMulti.split(\"\\n\");\n+            for (String comment : commentArray) {\n+\n+                comment = comment.replaceAll(\"//|/\\\\*\\\\*|/\\\\*|\\\\*\\\\*/|\\\\*/\", \"\")\n\nReview Comment:\n   > I do think people will want to maintain this kind of code.\r\n   I'll amend that and I won't touch the comments so they're not needed here.\n\n\n\n", "created": "2024-11-07T14:36:34.829+0000", "updated": "2024-11-07T14:36:34.829+0000", "started": "2024-11-07T14:36:34.828+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942467", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942487", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2462444410\n\n   Hi @kezhuw , I made some changes, could you take a look at it for me?\n\n\n", "created": "2024-11-07T14:56:06.417+0000", "updated": "2024-11-07T14:56:06.417+0000", "started": "2024-11-07T14:56:06.417+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942487", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/942491", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2462473973\n\n   Hi @kezhuw  ,  I made some changes, could you take a look at it for me?\r\n   \r\n   I won't touch the annotation content now.\r\n   \r\n   > But I still formatted it a little bit here, because for example, field needs a few spaces, class does not need spaces, and the number of spaces in java and c is also different.\r\n   ```java\r\n     private static String getComments(String space, List<String> commentList) {\r\n         if (commentList == null || commentList.isEmpty()) {\r\n             return \"\";\r\n         }\r\n   \r\n         String comments = String.join(\"\", commentList);\r\n   \r\n         StringBuilder formatBuilder = new StringBuilder();\r\n         for (String s : comments.split(\"\\r?\\n\")) {\r\n             formatBuilder.append(\"\\n\")\r\n                     .append(space)\r\n                     .append(s.replaceAll(\"^[ \\t]+\", \"\"));\r\n         }\r\n   \r\n         return formatBuilder.append(\"\\n\").toString();\r\n     }\r\n   ````\r\n   \r\n   Now the comment is like this\r\n   <img width=\"1343\" alt=\"image\" src=\"https://github.com/user-attachments/assets/d018d3cf-d30f-49b3-a4fd-90008f0e7f06\">\r\n   <img width=\"1256\" alt=\"image\" src=\"https://github.com/user-attachments/assets/38ba86f4-cc0b-4156-8bc7-6540abe3b20e\">\r\n   \n\n\n", "created": "2024-11-07T15:07:46.490+0000", "updated": "2024-11-07T15:07:46.490+0000", "started": "2024-11-07T15:07:46.490+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "942491", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/943695", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2475347667\n\n   Hi @kezhuw, These days, I have researched how JavaParser and Protobuf handle comments againã€‚\n\n\n", "created": "2024-11-14T03:39:18.361+0000", "updated": "2024-11-14T03:39:18.361+0000", "started": "2024-11-14T03:39:18.360+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "943695", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/943698", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2475410906\n\n   Hi @kezhuw, These days, I have researched how JavaParser and Protobuf handle comments again.\r\n   \r\n   The [Comment#content](https://github.com/javaparser/javaparser/blob/master/javaparser-core/src/main/java/com/github/javaparser/ast/comments/Comment.java) method of Javaparser can retrieve the content inside the comment, which will remove the first layer`/**   */` or `/*   */` or `//` .  \r\n   I think I might also be able to obtain the internal content of comments in this way for formatting purposes.\r\n   \r\n   The creatCommentFromToken method is the process of handling content\r\n   https://github.com/javaparser/javaparser/blob/master/javaparser-core/src/main/javacc-support/com/github/javaparser/GeneratedJavaParserTokenManagerBase.java\r\n   \r\n   <br>\r\n   Then I also tested the process of protobuf handling comments.\r\n   \r\n   protobuf will format `/**  */` or `/*  */` or `//` as `/**  */`. \r\n   <img width=\"1338\" alt=\"image\" src=\"https://github.com/user-attachments/assets/dfd81b38-a7e8-46a1-a75a-9c6d50339808\">\r\n   \r\n   Will convert multi line comments nested within single line comments into `Html Entity`. (Because multi line comments cannot be nested within each other)\r\n   \r\n   <img width=\"1367\" alt=\"image\" src=\"https://github.com/user-attachments/assets/eae37bd6-dbc4-4e1a-8083-c49be44e7b4e\">\r\n   \r\n   <img width=\"1342\" alt=\"image\" src=\"https://github.com/user-attachments/assets/a7b62be8-128b-4eac-8f9d-a4c9c61b697c\">\r\n   \r\n   So I think I just need to handle the following single line comments and a few situations\r\n   ```text\r\n   /*       /*        /**         /**\r\n             *                     *\r\n             *                     *\r\n   */        */        */          */\r\n   ```\r\n   For internal comments, I only need to convert`/*` and `*/` to `HTML Entity` (because multi line comments cannot be nested)\r\n   \r\n   So can I make further modifications this way or are there any issues I haven't thought of?\n\n\n", "created": "2024-11-14T04:50:46.641+0000", "updated": "2024-11-14T04:50:46.641+0000", "started": "2024-11-14T04:50:46.641+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "943698", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/944243", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1847720246\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JCommentGenerator.java:\n##########\n@@ -0,0 +1,183 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.jute.compiler;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.NavigableMap;\n+import java.util.Optional;\n+import java.util.TreeMap;\n+import java.util.TreeSet;\n+import org.apache.jute.compiler.generated.Token;\n+\n+public class JCommentGenerator {\n+\n+    /**\n+     * {fieldCommentsBeginLineNumber : {fieldCommentsBeginColumn : fieldCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> fieldCommentsTokenMap = new TreeMap<>();\n+\n+    /**\n+     * {recordCommentsBeginLineNumber : {recordCommentsBeginColumn : recordCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> recordCommentsTokenMap = new TreeMap<>();\n+\n+    private final TreeSet<RangeInfo> jFieldTreeSet = new TreeSet<>();\n+\n+    private final TreeSet<RangeInfo> jRecordTreeSet = new TreeSet<>();\n+\n+    public void addJRecord(JRecord jRecord) {\n+        jRecordTreeSet.add(jRecord);\n+    }\n+\n+    public void addJField(JField jField) {\n+        jFieldTreeSet.add(jField);\n+    }\n+\n+    public void putFieldSpecialToken(Token fieldToken) {\n+        putSpecialToken(fieldToken, fieldCommentsTokenMap);\n+    }\n+\n+    public void putRecordSpecialToken(Token recordToken) {\n+        putSpecialToken(recordToken, recordCommentsTokenMap);\n+    }\n+\n+    private static void putSpecialToken(Token classToken, TreeMap<Integer, TreeMap<Integer, Token>> commentsTokenMap) {\n+        if (classToken == null || classToken.specialToken == null || commentsTokenMap == null) {\n+            return;\n+        }\n+\n+        Token tmp = classToken;\n+        while ((tmp = tmp.specialToken) != null && tmp.image != null) {\n+            commentsTokenMap.computeIfAbsent(tmp.beginLine, key -> new TreeMap<>())\n+                    .putIfAbsent(tmp.beginColumn, tmp);\n+        }\n+    }\n+\n+    public List<String> getRecordCommentsList(JRecord jRecord) {\n+        return getCommentsList(jRecord, jRecordTreeSet, recordCommentsTokenMap);\n+    }\n+\n+    public List<String> getFieldCommentsList(JField jField) {\n+        return getCommentsList(jField, jFieldTreeSet, fieldCommentsTokenMap);\n+    }\n+\n+    private static List<String> getCommentsList(RangeInfo rangeInfo,\n\nReview Comment:\n   I expect this should be much clear. Given that we support only comments in three places:\r\n   1. Comments before `class` for record types.\r\n   2. Comments before fields.\r\n   3. Line ending comments for fields.\r\n   \r\n   For the first, we could extract comments from `Token::specialToken`. For the second, similar to the first, but we have to drop comments(could be in either `//` or `/* */` form) belong to previous field. For the third, additional lookup is required, also drop comments belong to next field.\n\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JCommentGenerator.java:\n##########\n@@ -0,0 +1,183 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.jute.compiler;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.NavigableMap;\n+import java.util.Optional;\n+import java.util.TreeMap;\n+import java.util.TreeSet;\n+import org.apache.jute.compiler.generated.Token;\n+\n+public class JCommentGenerator {\n+\n+    /**\n+     * {fieldCommentsBeginLineNumber : {fieldCommentsBeginColumn : fieldCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> fieldCommentsTokenMap = new TreeMap<>();\n+\n+    /**\n+     * {recordCommentsBeginLineNumber : {recordCommentsBeginColumn : recordCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> recordCommentsTokenMap = new TreeMap<>();\n+\n+    private final TreeSet<RangeInfo> jFieldTreeSet = new TreeSet<>();\n+\n+    private final TreeSet<RangeInfo> jRecordTreeSet = new TreeSet<>();\n+\n+    public void addJRecord(JRecord jRecord) {\n+        jRecordTreeSet.add(jRecord);\n+    }\n+\n+    public void addJField(JField jField) {\n+        jFieldTreeSet.add(jField);\n\nReview Comment:\n   `extends RangeInfo` is aggressive. `addCommentRange(JXyz jXyz, RangeInfo rangeInfo)` should be sufficient.\n\n\n\n", "created": "2024-11-19T06:55:21.464+0000", "updated": "2024-11-19T06:55:21.464+0000", "started": "2024-11-19T06:55:21.464+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "944243", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/944248", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1847769128\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JCommentGenerator.java:\n##########\n@@ -0,0 +1,183 @@\n+/*\n+ * Licensed to the Apache Software Foundation (ASF) under one\n+ * or more contributor license agreements.  See the NOTICE file\n+ * distributed with this work for additional information\n+ * regarding copyright ownership.  The ASF licenses this file\n+ * to you under the Apache License, Version 2.0 (the\n+ * \"License\"); you may not use this file except in compliance\n+ * with the License.  You may obtain a copy of the License at\n+ *\n+ *     http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ * Unless required by applicable law or agreed to in writing, software\n+ * distributed under the License is distributed on an \"AS IS\" BASIS,\n+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ * See the License for the specific language governing permissions and\n+ * limitations under the License.\n+ */\n+\n+package org.apache.jute.compiler;\n+\n+import java.util.ArrayList;\n+import java.util.Collections;\n+import java.util.Iterator;\n+import java.util.List;\n+import java.util.Map;\n+import java.util.NavigableMap;\n+import java.util.Optional;\n+import java.util.TreeMap;\n+import java.util.TreeSet;\n+import org.apache.jute.compiler.generated.Token;\n+\n+public class JCommentGenerator {\n+\n+    /**\n+     * {fieldCommentsBeginLineNumber : {fieldCommentsBeginColumn : fieldCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> fieldCommentsTokenMap = new TreeMap<>();\n+\n+    /**\n+     * {recordCommentsBeginLineNumber : {recordCommentsBeginColumn : recordCommentsToken}}.\n+     */\n+    private final TreeMap<Integer, TreeMap<Integer, Token>> recordCommentsTokenMap = new TreeMap<>();\n+\n+    private final TreeSet<RangeInfo> jFieldTreeSet = new TreeSet<>();\n+\n+    private final TreeSet<RangeInfo> jRecordTreeSet = new TreeSet<>();\n+\n+    public void addJRecord(JRecord jRecord) {\n+        jRecordTreeSet.add(jRecord);\n+    }\n+\n+    public void addJField(JField jField) {\n+        jFieldTreeSet.add(jField);\n\nReview Comment:\n   OK, I will modify it\n\n\n\n", "created": "2024-11-19T07:25:08.080+0000", "updated": "2024-11-19T07:25:08.080+0000", "started": "2024-11-19T07:25:08.079+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "944248", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/944877", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "luozongle01 commented on PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#issuecomment-2491334165\n\n   Hi @kezhuw,  Thank you for your review last time. The code feels much more concise now.\r\n   Could you take another look at it for me?\n\n\n", "created": "2024-11-21T14:17:22.176+0000", "updated": "2024-11-21T14:17:22.176+0000", "started": "2024-11-21T14:17:22.176+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "944877", "issueId": "13596328"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/worklog/945593", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=githubbot", "name": "githubbot", "key": "githubbot", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?avatarId=10452", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"}, "displayName": "ASF GitHub Bot", "active": true, "timeZone": "Etc/UTC"}, "comment": "kezhuw commented on code in PR #2206:\nURL: https://github.com/apache/zookeeper/pull/2206#discussion_r1857737011\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +793,88 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    public String getJavaFieldComments(JField jField) {\n+        return getFieldComments(jField, \"  \");\n+    }\n+\n+    public String getCFieldComments(JField jField) {\n+        return getFieldComments(jField, \"    \");\n+    }\n+\n+    private String getFieldComments(JField jField, String space) {\n+        if (jField == null || jField.getTypeToken() == null || jField.getNextToken() == null) {\n+            return \"\";\n+        }\n+\n+        // get the comment before the line\n+        List<String> comments = getComments(jField.getTypeToken().specialToken);\n+\n+        // get the end-of-line comments of fields\n+        // If the current field and the next field are on the same line,\n+        // the leading field comment of the next field should be discarded\n+        Token tmpToken = jField.getNextToken();\n+        while (tmpToken.specialToken != null) {\n+\n+            if (jField.getTypeToken().beginLine == tmpToken.specialToken.beginLine) {\n+                Token endLineComments = tmpToken.specialToken;\n+                tmpToken.specialToken = null;\n+                comments.addAll(getComments(endLineComments));\n+                break;\n+            }\n+\n+            tmpToken = tmpToken.specialToken;\n+        }\n+\n+        return formatComments(space, comments);\n+    }\n+\n+    public String getRecordComments() {\n+        if (getRecordToken() == null || getRecordToken().specialToken == null) {\n+            return \"\";\n+        }\n+\n+        // get the comments before the class\n+        return formatComments(\"\", getComments(getRecordToken().specialToken));\n+    }\n+\n+    private static String formatComments(String space, List<String> commentList) {\n+        if (commentList == null || commentList.isEmpty()) {\n+            return \"\";\n+        }\n+\n+        String comments = String.join(\"\", commentList);\n+\n+        StringBuilder formatBuilder = new StringBuilder();\n+        for (String s : comments.split(\"\\r?\\n\")) {\n+            formatBuilder.append(\"\\n\")\n+                    .append(space)\n+                    .append(s.replaceAll(\"^[ \\t]+\", \"\"));\n+        }\n+\n+        return formatBuilder.append(\"\\n\").toString();\n+    }\n+\n+    private static List<String> getComments(Token token) {\n\nReview Comment:\n   Currently, all leading spaces in mult-line comment are dropped in generation. Can we reconstruct these for multi-line comment ?\r\n   \r\n   Or how about `<MULTI_LINE_COMMENT: \"/*\" (~[\"*\"])* \"*\" (~[\"*\",\"/\"] (~[\"*\"])* \"*\" | \"*\")* \"/\">` ? (https://stackoverflow.com/questions/34550579/multiline-comments-in-javacc)\r\n   \r\n   I find no hole despite there is one comment say that  \"not correct with respect to the language definition\".\r\n   \r\n   I think it is easy to reconstruct original format if multi-line comment is captured into one token.\n\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/generated/rcc.jj:\n##########\n@@ -111,17 +119,7 @@ SKIP :\n \n SPECIAL_TOKEN :\n {\n-  \"//\" : WithinOneLineComment\n-}\n-\n-<WithinOneLineComment> SPECIAL_TOKEN :\n-{\n-  <(\"\\n\" | \"\\r\" | \"\\r\\n\" )> : DEFAULT\n-}\n-\n-<WithinOneLineComment> MORE :\n-{\n-  <~[]>\n+  <WithinOneLineComment: \"//\" (~[\"\\n\",\"\\r\"])* (\"\\n\"|\"\\r\"|\"\\r\\n\")>\n\nReview Comment:\n   Should be \"ONE_LINE_COMMENT\" ? It is as a \"Token.kind\" constant in generated in \"RccConstants\".\n\n\n\n##########\nzookeeper-jute/src/main/java/org/apache/jute/compiler/JRecord.java:\n##########\n@@ -767,4 +793,88 @@ public static String getCsharpFQName(String name) {\n         }\n         return fQName.toString();\n     }\n+\n+    public String getJavaFieldComments(JField jField) {\n+        return getFieldComments(jField, \"  \");\n+    }\n+\n+    public String getCFieldComments(JField jField) {\n+        return getFieldComments(jField, \"    \");\n+    }\n+\n+    private String getFieldComments(JField jField, String space) {\n\nReview Comment:\n   s/space/indent/ ?\n\n\n\n", "created": "2024-11-26T04:03:08.843+0000", "updated": "2024-11-26T04:03:08.843+0000", "started": "2024-11-26T04:03:08.843+0000", "timeSpent": "10m", "timeSpentSeconds": 600, "id": "945593", "issueId": "13596328"}]}, "archivedby": null, "customfield_12313920": null, "issuetype": {"self": "https://issues.apache.org/jira/rest/api/2/issuetype/4", "id": "4", "description": "An improvement or enhancement to an existing feature or task.", "iconUrl": "https://issues.apache.org/jira/secure/viewavatar?size=xsmall&avatarId=21140&avatarType=issuetype", "name": "Improvement", "subtask": false, "avatarId": 21140}, "timespent": 27600, "customfield_12314020": "{summaryBean=com.atlassian.jira.plugin.devstatus.rest.SummaryBean@12b6a74a[summary={pullrequest=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@3faaabc5[overall=PullRequestOverallBean{stateCount=0, state='OPEN', details=PullRequestOverallDetails{openCount=0, mergedCount=0, declinedCount=0}},byInstanceType={}], build=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@d6f4bb7[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BuildOverallBean@67f12d5c[failedBuildCount=0,successfulBuildCount=0,unknownBuildCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], review=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@79182c20[overall=com.atlassian.jira.plugin.devstatus.summary.beans.ReviewsOverallBean@727d78e4[stateCount=0,state=<null>,dueDate=<null>,overDue=false,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], deployment-environment=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@5b8a7ef[overall=com.atlassian.jira.plugin.devstatus.summary.beans.DeploymentOverallBean@6b4df1c9[topEnvironments=[],showProjects=false,successfulCount=0,count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], repository=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@538ca9ac[overall=com.atlassian.jira.plugin.devstatus.summary.beans.CommitOverallBean@4a2f5161[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}], branch=com.atlassian.jira.plugin.devstatus.rest.SummaryItemBean@a681014[overall=com.atlassian.jira.plugin.devstatus.summary.beans.BranchOverallBean@eaf6b29[count=0,lastUpdated=<null>,lastUpdatedTimestamp=<null>],byInstanceType={}]},errors=[],configErrors=[]], devSummaryJson={\"cachedValue\":{\"errors\":[],\"configErrors\":[],\"summary\":{\"pullrequest\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":\"OPEN\",\"details\":{\"openCount\":0,\"mergedCount\":0,\"declinedCount\":0,\"total\":0},\"open\":true},\"byInstanceType\":{}},\"build\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"failedBuildCount\":0,\"successfulBuildCount\":0,\"unknownBuildCount\":0},\"byInstanceType\":{}},\"review\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"stateCount\":0,\"state\":null,\"dueDate\":null,\"overDue\":false,\"completed\":false},\"byInstanceType\":{}},\"deployment-environment\":{\"overall\":{\"count\":0,\"lastUpdated\":null,\"topEnvironments\":[],\"showProjects\":false,\"successfulCount\":0},\"byInstanceType\":{}},\"repository\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}},\"branch\":{\"overall\":{\"count\":0,\"lastUpdated\":null},\"byInstanceType\":{}}}},\"isStale\":false}}", "customfield_12314141": null, "customfield_12314140": null, "project": {"self": "https://issues.apache.org/jira/rest/api/2/project/12310801", "id": "12310801", "key": "ZOOKEEPER", "name": "ZooKeeper", "projectTypeKey": "software", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011", "24x24": "https://issues.apache.org/jira/secure/projectavatar?size=small&pid=12310801&avatarId=10011", "16x16": "https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=12310801&avatarId=10011", "32x32": "https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=12310801&avatarId=10011"}, "projectCategory": {"self": "https://issues.apache.org/jira/rest/api/2/projectCategory/10484", "id": "10484", "description": "Apache ZooKeeper related", "name": "ZooKeeper"}}, "aggregatetimespent": 27600, "customfield_12312520": null, "customfield_12312521": "Sat Dec 07 05:55:30 UTC 2024", "customfield_12314422": null, "customfield_12314421": null, "customfield_12314146": null, "customfield_12314420": null, "customfield_12314145": null, "customfield_12314144": null, "customfield_12314143": null, "resolutiondate": "2024-12-07T05:55:30.000+0000", "workratio": -1, "customfield_12312923": null, "customfield_12312920": null, "customfield_12312921": null, "watches": {"self": "https://issues.apache.org/jira/rest/api/2/issue/ZOOKEEPER-4880/watchers", "watchCount": 2, "isWatching": false}, "created": "2024-10-22T12:52:23.000+0000", "customfield_12310192": null, "customfield_12310191": null, "customfield_12310230": null, "updated": "2024-12-07T06:03:02.000+0000", "timeoriginalestimate": null, "description": "When I was learning protobuf, I found that the comments in the proto file would be generated into the code. I think this feature is very useful. I wonder if this feature can be added to zookeeper, because in the process of learning zookeeper, we can directly see the attribute comments of the relevant classes generated by jute, and there is no need to check the meaning of the fields in zookeeper.jute. Although I found that there are not many comments in the zookeeper.jute file, I think it would be helpful to generate the comments into the code.\r\n\r\nAnd I studied javacc and found that javacc supports this feature. We can get the comments in zookeeper.jute through SPECIAL_TOKEN.\r\n\r\nIf possible, I hope to contribute a PR.", "customfield_10010": null, "timetracking": {"remainingEstimate": "0h", "timeSpent": "7h 40m", "remainingEstimateSeconds": 0, "timeSpentSeconds": 27600}, "customfield_12314523": null, "customfield_12314127": null, "customfield_12314522": null, "customfield_12314126": null, "customfield_12314521": null, "customfield_12314125": null, "customfield_12314520": null, "customfield_12314124": null, "customfield_12312340": null, "attachment": [], "customfield_12314123": null, "customfield_12312341": null, "customfield_12312220": null, "customfield_12314122": null, "customfield_12314121": null, "customfield_12314120": null, "customfield_12314129": null, "customfield_12314524": null, "customfield_12314128": null, "summary": "Generate comments from zookeeper.jute into code", "customfield_12314130": null, "customfield_12310291": null, "customfield_12310290": null, "customfield_12311024": null, "customfield_12314138": null, "customfield_12314137": null, "environment": null, "customfield_12314136": null, "customfield_12314135": null, "customfield_12311020": null, "customfield_12314134": null, "duedate": null, "customfield_12314132": null, "customfield_12314131": null, "comment": {"comments": [{"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/comment/17892097", "id": "17892097", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kezhuw", "name": "kezhuw", "key": "kezhuw", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kezhuw&avatarId=37929", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kezhuw&avatarId=37929", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kezhuw&avatarId=37929", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kezhuw&avatarId=37929"}, "displayName": "Kezhu Wang", "active": true, "timeZone": "Etc/GMT-8"}, "body": "+1\r\n\r\nLook forward to this.", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kezhuw", "name": "kezhuw", "key": "kezhuw", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kezhuw&avatarId=37929", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kezhuw&avatarId=37929", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kezhuw&avatarId=37929", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kezhuw&avatarId=37929"}, "displayName": "Kezhu Wang", "active": true, "timeZone": "Etc/GMT-8"}, "created": "2024-10-23T09:23:40.210+0000", "updated": "2024-10-23T09:23:40.210+0000"}, {"self": "https://issues.apache.org/jira/rest/api/2/issue/13596328/comment/17903794", "id": "17903794", "author": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kezhuw", "name": "kezhuw", "key": "kezhuw", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kezhuw&avatarId=37929", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kezhuw&avatarId=37929", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kezhuw&avatarId=37929", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kezhuw&avatarId=37929"}, "displayName": "Kezhu Wang", "active": true, "timeZone": "Etc/GMT-8"}, "body": "Issue resolved by pull request 2206\n[https://github.com/apache/zookeeper/pull/2206]", "updateAuthor": {"self": "https://issues.apache.org/jira/rest/api/2/user?username=kezhuw", "name": "kezhuw", "key": "kezhuw", "avatarUrls": {"48x48": "https://issues.apache.org/jira/secure/useravatar?ownerId=kezhuw&avatarId=37929", "24x24": "https://issues.apache.org/jira/secure/useravatar?size=small&ownerId=kezhuw&avatarId=37929", "16x16": "https://issues.apache.org/jira/secure/useravatar?size=xsmall&ownerId=kezhuw&avatarId=37929", "32x32": "https://issues.apache.org/jira/secure/useravatar?size=medium&ownerId=kezhuw&avatarId=37929"}, "displayName": "Kezhu Wang", "active": true, "timeZone": "Etc/GMT-8"}, "created": "2024-12-07T05:55:30.035+0000", "updated": "2024-12-07T05:55:30.035+0000"}], "maxResults": 2, "total": 2, "startAt": 0}, "customfield_12311820": "0|z1s53k:", "customfield_12314139": null}}